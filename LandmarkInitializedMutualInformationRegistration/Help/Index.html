<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title></title>
</head>
  <body>
    
<p>Landmark initialized 3D Mutual information Registration Help<br>
   </p>
    
<hr>   
<p>Content<br>
 </p>
 
<ol>
   <li><a href="#Introduction">Introduction</a></li>
   <li><a href="#HowTo">How to use the software</a></li>
   
  <ol>
     <li><a href="#Start">Starting the software</a><br>
    </li>
    <li><a href="#LoadImage">Loading images</a></li>
     <li><a href="#SelectLandmarks">Selecting landmarks</a><br>
     </li>
     
    <ol>
       
    </ol>
    <li><a href="#SelectROI">Selecting the region of interest</a></li>
     
    <ol>
            
    </ol>
     <li><a href="#Run">Running the registration</a><br>
     </li>
     <li><a href="#CheckResult">Checking the result</a></li>
     <li><a href="#SaveResult">Saving the result</a></li>
    <li><a href="#Quit">Quitting the software</a><br>
    </li>
   
  </ol>
 
</ol>
    
<ol>
      
</ol>
 
<hr>   
<h1>Introduction<a name="Introduction"></a> <a href="#"> </a></h1>
<div align="right"><a href="#">back to top</a>             <br>
<div align="left"><br>
This software provides ways to register two 3D images using rigid or affine 
transform. Both methods run after the initial landmark based registration. 
The initial landmarks based registration is sometimes very crucial to successful 
rigid or affine registration because the fixed image and the moving image 
might be initially aligned very poorly. <br>
      <br>
The rigid registaration method consists of the following ITK classes:<br>
   </div>
</div>
<ul>
  <li>QuaternionRigidTransform</li>
  <li>QuaternionRigidTransformGradientDescentOptimizer</li>
  <li>MutualInformationImageToImageMetric</li>
  <li>ImageRegistrationMethod.</li>
</ul>
The affine registration method consists of the following ITK classes:<br>
 
<blockquote>   </blockquote>
<ul>
  <li>AffineTransform</li>
  <li>GradientDescentOptimizer</li>
  <li>MutualInformationImageToImageMetric</li>
  <li>MultiResolutionImageRegistrationMethod</li>
</ul>
 The rigid method with single resultion registration strategy (ImageRegistrationMethod) 
works pretty well becase of the intitial landmark based registration. However, 
the affine registration method seems to need more robust strategy (multiresolution 
strategy - MultiResolutionImageRegistrationMethod). Since the both methods 
uses the mutual information metric, this tool can be used cross modality registration.<br>
<blockquote>   <br>
</blockquote>
 The followings are some notible features of this software:   
<ul>
     <li>Landmark based registration as preprocess</li>
  <li>Cross modality registration</li>
  <li>Region of interest selection with graphical user interface</li>
  <li>Saving and loading the registration results(image &amp; transform),
the registration options, and the landmarks<br>
  </li>
   
</ul>
 
<ol>
  <p>&#160;</p>
</ol>
<h1>How to use the software<a name="HowTo"></a></h1>
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 
<p>The usual procedure to register two images is:<br>
1) load the images,<br>
2) select the landmarks,<br>
3) select the region of interest,<br>
4) change the registration options,<br>
5) and, run the registration.<br>
</p>
<p>In the following sections, we will discuss about each step with related
registration options and user interface features.<br>
</p>
<h2>Starting the software<a name="Start"></a><br>
</h2>
<p>On unix like systems, change directory to the directory to where this
software is, type "./LandmarkInitializedMutualInformationRegistration" on
command line. On windows, you can open a command prompt winodw, change directory,
and type "LandmarkInitializedMutualInformationRegistration.exe". Or open
a windows explorer, select application directory and double click the "LandmarkInitializedMutualInformationRegistration.exe"<br>
 </p>
<h2>Loading images<a name="LoadImage"></a></h2>
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 We have first load the fixed image and the moving image. The moving image
is the image that transfomed to be aligned with the fixed image. Therefore,
the registration results such as the registered images and the transform
are only applicable to the moving image.<br>
<br>
To load the fixed image, we have to click the "Select Fixed Image" button
on the left-top corner of the main window. The file selection dialog box
will appear, we select the image name and click the "OK" button on the dialog
box. To load the moving image, we follow the same steps except that we click
the "Select Moving Image..." button. After we load the fixed and the moving
image, the landmark related buttons will be activated so that we can select
or load landmarks. On the right side of the main window, you should be able
to see an ovelapped image where the fixed image pixels are red and the moving
image pixels are green.<br>
<h2>Selecting landmarks<a name="SelectLandmarks"></a></h2>
     
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 The landmark based registration requires four landmarks for each image.
If you already have a landmark file that has four landmark positions (actually
with colors too), you can use the landmark file by loading the landmark file
using the "load landmakrs..." button next to the each image viewer. <br>
<br>
To manually select landmarks you might want to change the view axis and/or
slice. To change slices, you can use the long vertical slide bar between
two image viewer on the left side and the overlapped image viewer on the
right side. At the top of the slide bar, you can see the current slice number.
If you want to change the view axis, simply choose one of the view axis radio
buttons. After changing slice and view axis, if you find a position for a
landmark, click the one of the landmark toggle buttons which have different
colored button labels. For example, if the landmark should be the first landmark,
click the "Landmark 1" whose label color is blue. After you click the toggle
button, the circle on the left of the toggle button will be checked. you
place the mouse pointer to the desired location on the image viewer and click.
A cross mark colored with the corresponding toggle button label color will
appear. You have a landmark. Repeat this procedure for each landmark of the
fixed image and moving image. <br>
<br>
If you want to move to the slice where each landmark is on, click the "Go
to..." button next to each landmark toggle button.<br>
<br>
To remove an existing landmark, you must first erase the existing one and
then perform the landmark selection procedure again. Erasing a landmark is
done by clicking the landmark toggle button. The circle on the landmark toggel
button will be unchecked. That indicates one of your landmark has been removed.<br>
<br>
If you want to remove all existing landmark and start landmark selection
all over again, click the "clear landmakrs" button. To save the landmarks
in a file, you click the "save landmarks..." button and select a file name
for the output file in the file selection dialog box. If there are already
landmarks selected and you load landmarks from a landmark file, the existing
landmarks will be removed. <br>
<br>
<font color="#ff0000">NOTE</font>: If you don't provide four landmarks, the
landmark based registration part will be skipped and the loaded images are
used for the rigid or the affine registration. However, even you selected
less than four landmarks, those landmarks will appear on the registered image
after the transformation using the same transform that is the result of registration.<br>
<br>
<h3></h3>
<h2>Selecting the region of interest<a name="SelectROI"></a></h2>
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top<br>
</a>
<div align="left">The default region of interest for the rigid and the affine
registration is the region cover the whole fixed image. You can change this
behaviour by setting the "Region" options on the "Advanced Registration Options"
windows. <br>
<br>
You select the "Advaned Registration Options..." menu item from the "Options"
menu on top of the main window. Click the "Region" tab. You can specify different
region of interest options for the rigid registration and the affine registration.
The composition of options for each registration is identical. The default
option is "Use the whole image". There are two more options other than this
one. The "Use the region determined by the landmarks" option requires user
selected landmarks. <br>
<br>
The region determined by the landmarks will be a rectangluar region that
includes the all landmarks. The extent of each dimension is determined by
the smallest index value and the largest index value of all landmarks along
each dimension. If you think the region is too small and want to enlarge
you can change the "Landmark region scale" value. For example, you want to
make the region one and half time bigger than the region, change the value
to 1.5. While the size of region is changing, the center of region remains.
<br>
<br>
The "Use the user spcified region" option requires user interaction using
graphical user interface. Select the "User the user specified region" and
click the "OK" button on the bottom of the "Advanced Registration Options"
window. If you want to apply the changes you made in the "Adavanced Registration
Options" dialog box, you should always click the "OK" button. If you want
to discard the changes, click the "Cancel" button.<br>
<br>
</div>
</div>
 
<h2>Running the registration<a name="Run"></a></h2>
     
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 Before running restration by clicking the "Register" button below the overlapped
image viewer, you have to select the "Registration Method". You have two
options: "Rigid" or "Affine". The "Registration Method" drop down box is
located just next to the "Register" button.<br>
<h2>Checking the result<a name="CheckResult"></a></h2>
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 After the registration process finished, the moving image viewer (bottom
left) and the overlapped image viewer (right) shows the registered images.
The selection of the "Currently Displayed Moving Image" choice drop down
box has been changed to the "Registered Images." If the registration was
successful, you will see many pixels colored yellow because pixels between
the fixed image and the registered image overlap. You probably notice that
the landmark toggle buttons, the "clear landmarks", and the "load landmarks..."
button deactivated. However, you can use the "Go to..." buttons and the "save
landmarks..." button. By clicking the "Go to..." buttons, you can see the
landmarks transformed along with the registered image. If you specified four
landmarks before running registration, you will find the "Landmark registered
Images" item in the "Currently Displayed Moving Image" choice drop down box
is also activated. To see the landmark based registration result, select
that item. you can look at the each transformed landmark in the same way.<br>
<h2>Saving the result<a name="SaveResult"></a></h2>
<div align="right"><a
 href="file:///share/work/src/InsightApplications/LandmarkInitializedMutualInformationRegistration/Help/Index.html#">back
to top</a></div>
 To save the moving image registered by landmark based registration, select
the "Save landmark registered moving image..." menu item from the "File"
menu at the top. On the file selection dialog box, select the directory and
file name, and click the "OK" button. Saving the moving image registered
by the rigid or the affine method, follow the same procedure except that
you have to select the "Save registered final image..." menu item. The final
transform used to produce the "registered final image" can also be stored
in a file using the "Save transform..." menu item from the "File" menu.<br>
<br>
To save landmarks that you specified, click the "save landmarks..." button
next to the image viewer on the left side. If you want to save the transformed
landmarks, you have to change the selection of the "Currently Displayed Moving
Image" choice drop down box and then click the "save landmarks.." button.<br>
<br>
To save the registration options changed on the "Advanced Registration Options"
dialog box, select the "Save options..." menu item from the "Options" menu
at the top. Next time, if you want to use the saved options, select the "Load
options..." menu item below the "Save options..." menu item and select the
options file that you saved.<br>
<br>
<h2>Quitting the software<a name="Quit"></a></h2>
Click the "Quit" button below the overlapped image viewer.<br>
<br>
<br>
 <br>
</body>
</html>
